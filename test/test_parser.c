#include "test_parser.h"
#include <CUnit/CUnit.h>
#include <CUnit/Basic.h>

int init_suite_parser (void) // operations to be done before all tests
{
    return 0;
}

int clean_suite_parser (void) // operations to be done after all tests
{
    return 0;
}

void test_ethernetParser (void)
{
    u_char *pFrame1 = malloc(sizeof(u_char*) * 1235);
    u_char *pFrame2 = malloc(sizeof(u_char*) * 74);
    u_char *pFrame3 = malloc(sizeof(u_char*) * 72);
    generateFrames(pFrame1, pFrame2, pFrame3);
    Frame frame1, frame2, frame3;

    CU_ASSERT(ethernetParser(&frame1, pFrame1) == EXIT_SUCCESS);
    CU_ASSERT(ethernetParser(&frame2, pFrame2) == EXIT_SUCCESS);
    CU_ASSERT(ethernetParser(&frame3, pFrame3) == EXIT_SUCCESS);

    free(pFrame1);
    free(pFrame2);
    free(pFrame3);
}

void test_ipParser (void)
{
    u_char *pFrame1 = malloc(sizeof(u_char*) * 1235);
    u_char *pFrame2 = malloc(sizeof(u_char*) * 74);
    u_char *pFrame3 = malloc(sizeof(u_char*) * 72);
    generateFrames(pFrame1, pFrame2, pFrame3);
    Frame frame1, frame2, frame3;

    ethernetParser(&frame1, pFrame1);
    ethernetParser(&frame2, pFrame2);
    ethernetParser(&frame3, pFrame3);

    CU_ASSERT(ipParser(&frame1, pFrame1) == EXIT_SUCCESS);
    CU_ASSERT(ipParser(&frame2, pFrame2) == EXIT_SUCCESS);
    CU_ASSERT(ipParser(&frame3, pFrame3) == -2);

    free(pFrame1);
    free(pFrame2);
    free(pFrame3);
}

void test_tcpParser (void)
{
    u_char *pFrame1 = malloc(sizeof(u_char*) * 1235);
    u_char *pFrame2 = malloc(sizeof(u_char*) * 74);
    u_char *pFrame3 = malloc(sizeof(u_char*) * 72);
    generateFrames(pFrame1, pFrame2, pFrame3);
    Frame frame1, frame2;

    ethernetParser(&frame1, pFrame1);
    ethernetParser(&frame2, pFrame2);

    ipParser(&frame1, pFrame1);
    ipParser(&frame2, pFrame2);

    CU_ASSERT(tcpParser(&frame1, pFrame1) == EXIT_SUCCESS);
    CU_ASSERT(tcpParser(&frame2, pFrame2) == EXIT_SUCCESS);

    free(pFrame1);
    free(pFrame2);
    free(pFrame3);
}

void test_httpParser (void)
{
    u_char *pFrame1 = malloc(sizeof(u_char*) * 1235);
    u_char *pFrame2 = malloc(sizeof(u_char*) * 74);
    u_char *pFrame3 = malloc(sizeof(u_char*) * 72);
    generateFrames(pFrame1, pFrame2, pFrame3);
    Frame frame1;
    Result *pResult = malloc(sizeof(Result));

    ethernetParser(&frame1, pFrame1);
    ipParser(&frame1, pFrame1);
    tcpParser(&frame1, pFrame1);

    CU_ASSERT(httpParser(&frame1, pResult) == EXIT_SUCCESS && strcmp((char*) pResult->http_method, "GET") == 0 && strcmp((char*) pResult->http_request_uri, "/") == 0 && strcmp((char*) pResult->http_host, "www.google.com") == 0);

    free(pFrame1);
    free(pFrame2);
    free(pFrame3);
}

void test_parser (void)
{
    u_char *pFrame1 = malloc(sizeof(u_char*) * 1235);
    u_char *pFrame2 = malloc(sizeof(u_char*) * 74);
    u_char *pFrame3 = malloc(sizeof(u_char*) * 72);
    Result *pResult = malloc(sizeof(Result));
    generateFrames(pFrame1, pFrame2, pFrame3);

    CU_ASSERT(parser(pFrame1, pResult) == EXIT_SUCCESS && strcmp((char*) pResult->http_method, "GET") == 0 && strcmp((char*) pResult->http_request_uri, "/") == 0 && strcmp((char*) pResult->http_host, "www.google.com") == 0);
    CU_ASSERT(parser(pFrame2, pResult) == EXIT_FAILURE);
    CU_ASSERT(parser(pFrame3, pResult) == EXIT_FAILURE);


    free(pFrame1);
    free(pFrame2);
    free(pFrame3);
}

int generateFrames (u_char* pFrame1, u_char* pFrame2, u_char* pFrame3)
{
    // Valid frame
    u_char frame1[1235] = {
        0x00, 0x23, 0x5e, 0xf1, 0x90, 0xbf, 0x00, 0x23, /* .#^....# */
        0x8b, 0xab, 0x6e, 0x68, 0x08, 0x00, 0x45, 0x00, /* ..nh..E. */
        0x04, 0xc5, 0xee, 0x9d, 0x40, 0x00, 0x40, 0x06, /* ....@.@. */
        0xd3, 0x73, 0x9d, 0x9f, 0x2d, 0x63, 0xd8, 0x3a, /* .s..-c.: */
        0xd0, 0xe4, 0xa8, 0xf1, 0x00, 0x50, 0x12, 0x87, /* .....P.. */
        0x43, 0x10, 0x6e, 0xd4, 0xd3, 0x57, 0x80, 0x18, /* C.n..W.. */
        0x00, 0xe5, 0x78, 0xd9, 0x00, 0x00, 0x01, 0x01, /* ..x..... */
        0x08, 0x0a, 0x03, 0x49, 0xad, 0x9f, 0x0b, 0xf4, /* ...I.... */
        0xe8, 0x0b, 0x47, 0x45, 0x54, 0x20, 0x2f, 0x20, /* ..GET /  */
        0x48, 0x54, 0x54, 0x50, 0x2f, 0x31, 0x2e, 0x31, /* HTTP/1.1 */
        0x0d, 0x0a, 0x48, 0x6f, 0x73, 0x74, 0x3a, 0x20, /* ..Host:  */
        0x77, 0x77, 0x77, 0x2e, 0x67, 0x6f, 0x6f, 0x67, /* www.goog */
        0x6c, 0x65, 0x2e, 0x63, 0x6f, 0x6d, 0x0d, 0x0a, /* le.com.. */
        0x43, 0x6f, 0x6e, 0x6e, 0x65, 0x63, 0x74, 0x69, /* Connecti */
        0x6f, 0x6e, 0x3a, 0x20, 0x6b, 0x65, 0x65, 0x70, /* on: keep */
        0x2d, 0x61, 0x6c, 0x69, 0x76, 0x65, 0x0d, 0x0a, /* -alive.. */
        0x41, 0x63, 0x63, 0x65, 0x70, 0x74, 0x3a, 0x20, /* Accept:  */
        0x74, 0x65, 0x78, 0x74, 0x2f, 0x68, 0x74, 0x6d, /* text/htm */
        0x6c, 0x2c, 0x61, 0x70, 0x70, 0x6c, 0x69, 0x63, /* l,applic */
        0x61, 0x74, 0x69, 0x6f, 0x6e, 0x2f, 0x78, 0x68, /* ation/xh */
        0x74, 0x6d, 0x6c, 0x2b, 0x78, 0x6d, 0x6c, 0x2c, /* tml+xml, */
        0x61, 0x70, 0x70, 0x6c, 0x69, 0x63, 0x61, 0x74, /* applicat */
        0x69, 0x6f, 0x6e, 0x2f, 0x78, 0x6d, 0x6c, 0x3b, /* ion/xml; */
        0x71, 0x3d, 0x30, 0x2e, 0x39, 0x2c, 0x69, 0x6d, /* q=0.9,im */
        0x61, 0x67, 0x65, 0x2f, 0x77, 0x65, 0x62, 0x70, /* age/webp */
        0x2c, 0x2a, 0x2f, 0x2a, 0x3b, 0x71, 0x3d, 0x30, /* ,**;q=0 */
        0x2e, 0x38, 0x0d, 0x0a, 0x55, 0x73, 0x65, 0x72, /* .8..User */
        0x2d, 0x41, 0x67, 0x65, 0x6e, 0x74, 0x3a, 0x20, /* -Agent:  */
        0x4d, 0x6f, 0x7a, 0x69, 0x6c, 0x6c, 0x61, 0x2f, /* Mozilla/ */
        0x35, 0x2e, 0x30, 0x20, 0x28, 0x58, 0x31, 0x31, /* 5.0 (X11 */
        0x3b, 0x20, 0x4c, 0x69, 0x6e, 0x75, 0x78, 0x20, /* ; Linux  */
        0x78, 0x38, 0x36, 0x5f, 0x36, 0x34, 0x29, 0x20, /* x86_64)  */
        0x41, 0x70, 0x70, 0x6c, 0x65, 0x57, 0x65, 0x62, /* AppleWeb */
        0x4b, 0x69, 0x74, 0x2f, 0x35, 0x33, 0x37, 0x2e, /* Kit/537. */
        0x33, 0x36, 0x20, 0x28, 0x4b, 0x48, 0x54, 0x4d, /* 36 (KHTM */
        0x4c, 0x2c, 0x20, 0x6c, 0x69, 0x6b, 0x65, 0x20, /* L, like  */
        0x47, 0x65, 0x63, 0x6b, 0x6f, 0x29, 0x20, 0x43, /* Gecko) C */
        0x68, 0x72, 0x6f, 0x6d, 0x65, 0x2f, 0x34, 0x32, /* hrome/42 */
        0x2e, 0x30, 0x2e, 0x32, 0x33, 0x31, 0x31, 0x2e, /* .0.2311. */
        0x31, 0x33, 0x35, 0x20, 0x53, 0x61, 0x66, 0x61, /* 135 Safa */
        0x72, 0x69, 0x2f, 0x35, 0x33, 0x37, 0x2e, 0x33, /* ri/537.3 */
        0x36, 0x0d, 0x0a, 0x41, 0x63, 0x63, 0x65, 0x70, /* 6..Accep */
        0x74, 0x2d, 0x45, 0x6e, 0x63, 0x6f, 0x64, 0x69, /* t-Encodi */
        0x6e, 0x67, 0x3a, 0x20, 0x67, 0x7a, 0x69, 0x70, /* ng: gzip */
        0x2c, 0x20, 0x64, 0x65, 0x66, 0x6c, 0x61, 0x74, /* , deflat */
        0x65, 0x2c, 0x20, 0x73, 0x64, 0x63, 0x68, 0x0d, /* e, sdch. */
        0x0a, 0x41, 0x63, 0x63, 0x65, 0x70, 0x74, 0x2d, /* .Accept- */
        0x4c, 0x61, 0x6e, 0x67, 0x75, 0x61, 0x67, 0x65, /* Language */
        0x3a, 0x20, 0x65, 0x6e, 0x2d, 0x55, 0x53, 0x2c, /* : en-US, */
        0x65, 0x6e, 0x3b, 0x71, 0x3d, 0x30, 0x2e, 0x38, /* en;q=0.8 */
        0x2c, 0x66, 0x72, 0x3b, 0x71, 0x3d, 0x30, 0x2e, /* ,fr;q=0. */
        0x36, 0x0d, 0x0a, 0x43, 0x6f, 0x6f, 0x6b, 0x69, /* 6..Cooki */
        0x65, 0x3a, 0x20, 0x53, 0x49, 0x44, 0x3d, 0x44, /* e: SID=D */
        0x51, 0x41, 0x41, 0x41, 0x44, 0x63, 0x42, 0x41, /* QAAADcBA */
        0x41, 0x41, 0x4a, 0x64, 0x56, 0x6d, 0x46, 0x76, /* AAJdVmFv */
        0x37, 0x39, 0x50, 0x4f, 0x6f, 0x33, 0x5a, 0x6a, /* 79POo3Zj */
        0x56, 0x4d, 0x4c, 0x44, 0x43, 0x77, 0x66, 0x59, /* VMLDCwfY */
        0x73, 0x4f, 0x76, 0x4a, 0x70, 0x5a, 0x41, 0x6c, /* sOvJpZAl */
        0x50, 0x55, 0x6c, 0x2d, 0x61, 0x53, 0x4e, 0x46, /* PUl-aSNF */
        0x59, 0x50, 0x47, 0x32, 0x33, 0x45, 0x74, 0x62, /* YPG23Etb */
        0x44, 0x30, 0x32, 0x4d, 0x7a, 0x38, 0x35, 0x65, /* D02Mz85e */
        0x7a, 0x74, 0x50, 0x54, 0x37, 0x7a, 0x46, 0x49, /* ztPT7zFI */
        0x51, 0x71, 0x35, 0x38, 0x57, 0x74, 0x6f, 0x37, /* Qq58Wto7 */
        0x41, 0x76, 0x72, 0x69, 0x53, 0x63, 0x70, 0x64, /* AvriScpd */
        0x70, 0x34, 0x50, 0x59, 0x73, 0x71, 0x78, 0x5f, /* p4PYsqx_ */
        0x76, 0x6d, 0x49, 0x4b, 0x59, 0x72, 0x54, 0x38, /* vmIKYrT8 */
        0x7a, 0x74, 0x31, 0x37, 0x39, 0x49, 0x38, 0x73, /* zt179I8s */
        0x35, 0x78, 0x75, 0x34, 0x34, 0x32, 0x65, 0x4b, /* 5xu442eK */
        0x56, 0x52, 0x69, 0x41, 0x59, 0x4b, 0x4a, 0x4f, /* VRiAYKJO */
        0x32, 0x74, 0x56, 0x6b, 0x5f, 0x69, 0x46, 0x31, /* 2tVk_iF1 */
        0x4b, 0x58, 0x6c, 0x63, 0x37, 0x6c, 0x72, 0x6b, /* KXlc7lrk */
        0x4b, 0x64, 0x68, 0x5a, 0x72, 0x4b, 0x5a, 0x4f, /* KdhZrKZO */
        0x37, 0x4c, 0x74, 0x48, 0x51, 0x6c, 0x59, 0x59, /* 7LtHQlYY */
        0x6d, 0x4d, 0x56, 0x6b, 0x72, 0x31, 0x4f, 0x63, /* mMVkr1Oc */
        0x76, 0x39, 0x42, 0x48, 0x6c, 0x75, 0x53, 0x44, /* v9BHluSD */
        0x43, 0x71, 0x68, 0x4e, 0x31, 0x31, 0x35, 0x77, /* CqhN115w */
        0x68, 0x33, 0x75, 0x73, 0x51, 0x56, 0x49, 0x56, /* h3usQVIV */
        0x36, 0x73, 0x30, 0x73, 0x49, 0x66, 0x59, 0x57, /* 6s0sIfYW */
        0x39, 0x38, 0x55, 0x76, 0x61, 0x5a, 0x4d, 0x53, /* 98UvaZMS */
        0x69, 0x77, 0x6e, 0x63, 0x45, 0x38, 0x66, 0x4c, /* iwncE8fL */
        0x4b, 0x49, 0x6a, 0x43, 0x6d, 0x41, 0x70, 0x6d, /* KIjCmApm */
        0x52, 0x6c, 0x52, 0x73, 0x63, 0x74, 0x6a, 0x30, /* RlRsctj0 */
        0x5f, 0x69, 0x4f, 0x4c, 0x4e, 0x34, 0x33, 0x66, /* _iOLN43f */
        0x49, 0x72, 0x7a, 0x66, 0x5a, 0x31, 0x44, 0x53, /* IrzfZ1DS */
        0x71, 0x38, 0x48, 0x42, 0x68, 0x77, 0x6c, 0x6b, /* q8HBhwlk */
        0x71, 0x36, 0x63, 0x6d, 0x31, 0x44, 0x52, 0x37, /* q6cm1DR7 */
        0x59, 0x52, 0x47, 0x4a, 0x57, 0x63, 0x33, 0x6a, /* YRGJWc3j */
        0x61, 0x6a, 0x6d, 0x45, 0x33, 0x5a, 0x47, 0x4d, /* ajmE3ZGM */
        0x58, 0x36, 0x69, 0x6b, 0x48, 0x4f, 0x78, 0x70, /* X6ikHOxp */
        0x75, 0x6b, 0x79, 0x52, 0x34, 0x72, 0x51, 0x39, /* ukyR4rQ9 */
        0x53, 0x55, 0x64, 0x30, 0x53, 0x44, 0x5a, 0x57, /* SUd0SDZW */
        0x54, 0x77, 0x75, 0x6b, 0x6a, 0x4a, 0x36, 0x59, /* TwukjJ6Y */
        0x4b, 0x71, 0x4c, 0x62, 0x4f, 0x35, 0x4f, 0x5a, /* KqLbO5OZ */
        0x50, 0x49, 0x6a, 0x79, 0x4b, 0x46, 0x52, 0x68, /* PIjyKFRh */
        0x31, 0x68, 0x61, 0x34, 0x4c, 0x4b, 0x55, 0x58, /* 1ha4LKUX */
        0x75, 0x69, 0x56, 0x66, 0x6b, 0x57, 0x77, 0x54, /* uiVfkWwT */
        0x6b, 0x35, 0x37, 0x6e, 0x7a, 0x61, 0x66, 0x4a, /* k57nzafJ */
        0x54, 0x6b, 0x58, 0x74, 0x77, 0x59, 0x4b, 0x59, /* TkXtwYKY */
        0x6b, 0x42, 0x65, 0x51, 0x6d, 0x76, 0x74, 0x58, /* kBeQmvtX */
        0x7a, 0x69, 0x70, 0x49, 0x45, 0x69, 0x70, 0x47, /* zipIEipG */
        0x39, 0x69, 0x49, 0x52, 0x49, 0x79, 0x33, 0x78, /* 9iIRIy3x */
        0x6f, 0x45, 0x7a, 0x6b, 0x34, 0x42, 0x5f, 0x32, /* oEzk4B_2 */
        0x6c, 0x4f, 0x70, 0x68, 0x6a, 0x4e, 0x4d, 0x4f, /* lOphjNMO */
        0x58, 0x66, 0x2d, 0x4e, 0x33, 0x59, 0x45, 0x32, /* Xf-N3YE2 */
        0x39, 0x4e, 0x56, 0x6c, 0x49, 0x43, 0x39, 0x59, /* 9NVlIC9Y */
        0x33, 0x7a, 0x2d, 0x5f, 0x6d, 0x79, 0x34, 0x77, /* 3z-_my4w */
        0x75, 0x37, 0x43, 0x77, 0x4e, 0x63, 0x65, 0x46, /* u7CwNceF */
        0x77, 0x79, 0x41, 0x76, 0x51, 0x3b, 0x20, 0x48, /* wyAvQ; H */
        0x53, 0x49, 0x44, 0x3d, 0x41, 0x58, 0x6b, 0x54, /* SID=AXkT */
        0x31, 0x66, 0x5a, 0x52, 0x64, 0x73, 0x30, 0x6f, /* 1fZRds0o */
        0x49, 0x30, 0x62, 0x53, 0x46, 0x3b, 0x20, 0x41, /* I0bSF; A */
        0x50, 0x49, 0x53, 0x49, 0x44, 0x3d, 0x34, 0x36, /* PISID=46 */
        0x6c, 0x66, 0x71, 0x7a, 0x54, 0x4e, 0x6c, 0x33, /* lfqzTNl3 */
        0x61, 0x38, 0x4e, 0x38, 0x50, 0x7a, 0x2f, 0x41, /* a8N8Pz/A */
        0x5f, 0x4f, 0x41, 0x74, 0x34, 0x37, 0x74, 0x6a, /* _OAt47tj */
        0x62, 0x48, 0x6f, 0x79, 0x5f, 0x31, 0x38, 0x6e, /* bHoy_18n */
        0x3b, 0x20, 0x50, 0x52, 0x45, 0x46, 0x3d, 0x49, /* ; PREF=I */
        0x44, 0x3d, 0x33, 0x66, 0x37, 0x64, 0x39, 0x61, /* D=3f7d9a */
        0x64, 0x33, 0x39, 0x65, 0x62, 0x39, 0x30, 0x66, /* d39eb90f */
        0x66, 0x30, 0x3a, 0x55, 0x3d, 0x37, 0x37, 0x39, /* f0:U=779 */
        0x33, 0x33, 0x65, 0x30, 0x30, 0x31, 0x32, 0x63, /* 33e0012c */
        0x66, 0x30, 0x65, 0x35, 0x64, 0x3a, 0x4c, 0x44, /* f0e5d:LD */
        0x3d, 0x66, 0x72, 0x3a, 0x54, 0x4d, 0x3d, 0x31, /* =fr:TM=1 */
        0x34, 0x33, 0x30, 0x39, 0x35, 0x35, 0x37, 0x35, /* 43095575 */
        0x36, 0x3a, 0x4c, 0x4d, 0x3d, 0x31, 0x34, 0x33, /* 6:LM=143 */
        0x31, 0x36, 0x34, 0x37, 0x38, 0x33, 0x38, 0x3a, /* 1647838: */
        0x53, 0x3d, 0x73, 0x48, 0x48, 0x69, 0x48, 0x61, /* S=sHHiHa */
        0x56, 0x42, 0x66, 0x7a, 0x43, 0x35, 0x58, 0x6d, /* VBfzC5Xm */
        0x6f, 0x33, 0x3b, 0x20, 0x4e, 0x49, 0x44, 0x3d, /* o3; NID= */
        0x36, 0x37, 0x3d, 0x67, 0x39, 0x64, 0x74, 0x4a, /* 67=g9dtJ */
        0x51, 0x53, 0x76, 0x57, 0x36, 0x36, 0x39, 0x70, /* QSvW669p */
        0x6b, 0x6d, 0x4a, 0x6d, 0x5f, 0x5f, 0x39, 0x4f, /* kmJm__9O */
        0x46, 0x71, 0x68, 0x70, 0x5a, 0x71, 0x2d, 0x37, /* FqhpZq-7 */
        0x52, 0x4c, 0x5a, 0x5a, 0x78, 0x4f, 0x44, 0x31, /* RLZZxOD1 */
        0x6d, 0x37, 0x48, 0x6f, 0x53, 0x43, 0x63, 0x65, /* m7HoSCce */
        0x59, 0x48, 0x6c, 0x78, 0x51, 0x78, 0x61, 0x69, /* YHlxQxai */
        0x4c, 0x68, 0x46, 0x71, 0x67, 0x58, 0x31, 0x44, /* LhFqgX1D */
        0x59, 0x68, 0x46, 0x4e, 0x48, 0x50, 0x4c, 0x74, /* YhFNHPLt */
        0x57, 0x4e, 0x54, 0x53, 0x7a, 0x42, 0x39, 0x2d, /* WNTSzB9- */
        0x44, 0x77, 0x74, 0x79, 0x7a, 0x79, 0x6c, 0x6e, /* Dwtyzyln */
        0x6b, 0x71, 0x69, 0x6e, 0x6e, 0x74, 0x7a, 0x70, /* kqinntzp */
        0x32, 0x56, 0x4d, 0x66, 0x4b, 0x77, 0x71, 0x32, /* 2VMfKwq2 */
        0x64, 0x44, 0x44, 0x37, 0x79, 0x52, 0x6c, 0x39, /* dDD7yRl9 */
        0x41, 0x72, 0x5a, 0x73, 0x51, 0x6b, 0x63, 0x54, /* ArZsQkcT */
        0x49, 0x56, 0x30, 0x67, 0x59, 0x55, 0x62, 0x77, /* IV0gYUbw */
        0x2d, 0x72, 0x35, 0x67, 0x57, 0x47, 0x49, 0x52, /* -r5gWGIR */
        0x41, 0x73, 0x72, 0x6a, 0x44, 0x36, 0x65, 0x77, /* AsrjD6ew */
        0x2d, 0x73, 0x38, 0x56, 0x62, 0x59, 0x67, 0x71, /* -s8VbYgq */
        0x59, 0x4f, 0x4a, 0x47, 0x75, 0x70, 0x68, 0x35, /* YOJGuph5 */
        0x67, 0x51, 0x69, 0x6f, 0x48, 0x6a, 0x43, 0x59, /* gQioHjCY */
        0x6a, 0x33, 0x4c, 0x6a, 0x5a, 0x53, 0x36, 0x5a, /* j3LjZS6Z */
        0x5f, 0x42, 0x6f, 0x43, 0x72, 0x30, 0x41, 0x35, /* _BoCr0A5 */
        0x6f, 0x4b, 0x6c, 0x75, 0x4d, 0x5a, 0x43, 0x38, /* oKluMZC8 */
        0x74, 0x56, 0x34, 0x39, 0x6c, 0x39, 0x4d, 0x0d, /* tV49l9M. */
        0x0a, 0x0d, 0x0a                                /* ... */
    };

    // Not HTTP frame (just TCP)
    u_char frame2[74] = {
        0x00, 0x23, 0x8b, 0xab, 0x6e, 0x68, 0x00, 0x23, /* .#..nh.# */
        0x5e, 0xf1, 0x90, 0xbf, 0x08, 0x00, 0x45, 0x00, /* ^.....E. */
        0x00, 0x3c, 0x00, 0x00, 0x40, 0x00, 0x3f, 0x06, /* .<..@.?. */
        0xce, 0xd7, 0xc1, 0x33, 0xe0, 0xae, 0x9d, 0x9f, /* ...3.... */
        0x2d, 0x63, 0x00, 0x50, 0x80, 0x9d, 0x19, 0x9a, /* -c.P.... */
        0x89, 0xe1, 0x2c, 0x8a, 0xb6, 0x4c, 0xa0, 0x12, /* ..,..L.. */
        0x38, 0x90, 0xf6, 0x5f, 0x00, 0x00, 0x02, 0x04, /* 8.._.... */
        0x05, 0xb4, 0x04, 0x02, 0x08, 0x0a, 0x0b, 0xf4, /* ........ */
        0xe8, 0x0b, 0x03, 0x49, 0xad, 0x94, 0x01, 0x03, /* ...I.... */
        0x03, 0x05                                      /* .. */
    };

    // Frame UDP 
    u_char frame3[72] = {
        0xc4, 0x2c, 0x03, 0x17, 0xab, 0xe5, 0x00, 0x23, /* .,.....# */
        0x5e, 0xf1, 0x90, 0xbf, 0x08, 0x00, 0x45, 0x00, /* ^.....E. */
        0x00, 0x3a, 0x67, 0xc4, 0x00, 0x00, 0x22, 0x11, /* .:g...". */
        0xef, 0x2d, 0x7c, 0xc8, 0xfa, 0x1f, 0x9d, 0x9f, /* .-|..... */
        0x2d, 0x3a, 0x35, 0xfd, 0x79, 0x27, 0x00, 0x26, /* -:5.y'.& */
        0x13, 0x64, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* .d...... */
        0x00, 0x00, 0x31, 0x00, 0x58, 0xaf, 0x00, 0x00, /* ..1.X... */
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* ........ */
        0x00, 0x00, 0x71, 0xa3, 0x00, 0x05, 0x00, 0x00  /* ..q..... */
    };

    memcpy(pFrame1, frame1, 1235);
    memcpy(pFrame2, frame2, 74);
    memcpy(pFrame3, frame3, 72);

    return 0;
}

